service:
  flush: 5
  daemon: off
  log_level: debug
  parsers_file: parsers.conf

input_forward:
  name: forward
  listen: 0.0.0.0
  port: 24224
  tag: lara-app.test

filter_parser:
  match: lara-app.test
  key_name: log
  parser: json
  reserve_data: on

filter_lua:
  match: lara-app.test
  script: /fluent-bit/etc/functions.lua
  call: transform_audit_log
  protected_mode: true

output_http:
  match: "*"
  host: clickhouse
  port: 8123
  uri: "/?query=INSERT%20INTO%20cmp_logs.audit_logs%20FORMAT%20JSONEachRow"
  format: json
  json_date_key: timestamp
  json_date_format: iso8601
  header_Content-Type: application/json 